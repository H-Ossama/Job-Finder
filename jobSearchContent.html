<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobSearch Pro - Find Your Dream Job</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .search-glow:focus-within {
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.3);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .job-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .job-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #764ba2, #667eea);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .filter-chip {
            transition: all 0.2s ease;
        }
        
        .filter-chip:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: rgba(99, 102, 241, 0.4);
        }
        
        .filter-chip.active {
            background: rgba(99, 102, 241, 0.3);
            border-color: rgba(99, 102, 241, 0.6);
            color: #c7d2fe;
        }
        
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
        }
        
        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            background-size: 200% 100%;
            animation: progress-glow 2s infinite linear;
        }
        
        @keyframes progress-glow {
            0% { background-position: 0% 0; }
            100% { background-position: 200% 0; }
        }
        
        .save-btn.saved {
            color: #fbbf24;
        }
        
        .save-btn.saved i {
            font-weight: 900;
        }
        
        .featured-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .platform-badge {
            font-size: 0.65rem;
            padding: 0.15rem 0.4rem;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
        }
        
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .notification-badge {
            transition: all 0.2s ease;
        }
        
        .notification-badge:hover {
            transform: translateY(-1px);
        }
        
        .select-styled {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%239ca3af'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1rem;
        }
        
        .preferences-bar {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .remote-toggle {
            transition: all 0.2s ease;
        }
        
        .remote-toggle.active {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.5);
            color: #86efac;
        }
    </style>
</head>
<body class="text-white">
    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-6">
            <h1 class="text-4xl md:text-5xl font-bold mb-3">
                Find Your <span class="text-gradient">Dream Job</span>
            </h1>
            <p class="text-gray-400 text-lg">Search real jobs from RemoteOK, Adzuna, The Muse, and more</p>
        </header>

        <!-- Notification Badges -->
        <div id="notificationBar" class="flex flex-wrap gap-2 mb-4">
            <!-- CV Creation Badge -->
            <a href="#" id="cvBadge" class="notification-badge inline-flex items-center gap-2 px-4 py-2 bg-amber-500/15 border border-amber-500/30 rounded-full text-sm text-amber-300 no-underline hover:bg-amber-500/25">
                <i class="fas fa-bolt"></i>
                <span>Create CV for AI matching</span>
            </a>
            <!-- Job Preferences Badge -->
            <a href="#" id="preferencesBadge" class="notification-badge inline-flex items-center gap-2 px-4 py-2 bg-indigo-500/15 border border-indigo-500/30 rounded-full text-sm text-indigo-300 no-underline hover:bg-indigo-500/25">
                <i class="fas fa-cog"></i>
                <span>Set job preferences</span>
            </a>
        </div>

        <!-- Preferences Bar (shown when preferences are set) -->
        <div id="preferencesBar" class="hidden preferences-bar rounded-xl p-4 mb-4">
            <div class="flex items-center justify-between flex-wrap gap-3">
                <div class="flex items-center gap-3 flex-wrap">
                    <div id="usingPreferencesIndicator" class="hidden items-center gap-2 px-3 py-1.5 bg-gradient-to-r from-indigo-500/20 to-purple-500/20 border border-purple-500/40 rounded-full text-sm">
                        <i class="fas fa-sparkles text-purple-400"></i>
                        <span class="text-indigo-100">
                            Searching: <strong id="prefTitles">Software Engineer</strong> in <strong id="prefLocation">United States</strong>
                        </span>
                    </div>
                    <div id="savedPreferencesIndicator" class="hidden items-center gap-2 px-3 py-1.5 bg-green-500/15 border border-green-500/30 rounded-full text-sm">
                        <span class="text-green-300">
                            Saved: <span id="savedPrefTitles">Software Engineer</span> in <span id="savedPrefLocation">United States</span>
                        </span>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button id="clearPreferencesBtn" class="hidden items-center gap-1.5 px-3 py-1.5 bg-white/10 border border-white/15 rounded-md text-xs text-gray-300 hover:bg-white/15 transition-colors">
                        <i class="fas fa-times"></i>
                        Clear
                    </button>
                    <button id="usePreferencesBtn" class="hidden items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-green-500/30 to-emerald-500/30 border border-green-500/50 rounded-md text-xs text-green-300 font-medium hover:from-green-500/40 hover:to-emerald-500/40 transition-colors">
                        <i class="fas fa-sparkles"></i>
                        Use preferences
                    </button>
                    <a href="#" class="flex items-center gap-1.5 px-3 py-1.5 bg-transparent border border-white/10 rounded-md text-xs text-gray-400 no-underline hover:bg-white/5 transition-colors">
                        <i class="fas fa-cog"></i>
                        Edit
                    </a>
                </div>
            </div>
        </div>

        <!-- Search Card -->
        <div class="glass-card rounded-2xl p-6 mb-4 search-glow transition-all duration-300">
            <form id="searchForm" class="space-y-4">
                <div class="grid md:grid-cols-12 gap-4">
                    <!-- Job Title Input -->
                    <div class="md:col-span-4">
                        <label class="block text-sm text-gray-400 mb-2">Job Title or Keywords</label>
                        <div class="relative">
                            <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                            <input type="text" id="searchQuery" placeholder="e.g. Software Engineer, React, Python"
                                class="w-full bg-gray-900/50 border border-gray-700 rounded-xl py-3 pl-12 pr-4 text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 transition-colors">
                        </div>
                    </div>
                    
                    <!-- Country Selector -->
                    <div class="md:col-span-3">
                        <label class="block text-sm text-gray-400 mb-2">Country</label>
                        <div class="relative">
                            <i class="fas fa-globe absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                            <select id="countrySelect" class="select-styled w-full bg-gray-900/50 border border-gray-700 rounded-xl py-3 pl-12 pr-10 text-white focus:outline-none focus:border-indigo-500 transition-colors cursor-pointer">
                                <option value="">All Countries</option>
                                <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
                                <option value="GB">ðŸ‡¬ðŸ‡§ United Kingdom</option>
                                <option value="DE">ðŸ‡©ðŸ‡ª Germany</option>
                                <option value="CA">ðŸ‡¨ðŸ‡¦ Canada</option>
                                <option value="AU">ðŸ‡¦ðŸ‡º Australia</option>
                                <option value="FR">ðŸ‡«ðŸ‡· France</option>
                                <option value="NL">ðŸ‡³ðŸ‡± Netherlands</option>
                                <option value="ES">ðŸ‡ªðŸ‡¸ Spain</option>
                                <option value="IT">ðŸ‡®ðŸ‡¹ Italy</option>
                                <option value="SE">ðŸ‡¸ðŸ‡ª Sweden</option>
                                <option value="CH">ðŸ‡¨ðŸ‡­ Switzerland</option>
                                <option value="AT">ðŸ‡¦ðŸ‡¹ Austria</option>
                                <option value="IE">ðŸ‡®ðŸ‡ª Ireland</option>
                                <option value="SG">ðŸ‡¸ðŸ‡¬ Singapore</option>
                                <option value="JP">ðŸ‡¯ðŸ‡µ Japan</option>
                                <option value="IN">ðŸ‡®ðŸ‡³ India</option>
                                <option value="BR">ðŸ‡§ðŸ‡· Brazil</option>
                                <option value="PL">ðŸ‡µðŸ‡± Poland</option>
                                <option value="PT">ðŸ‡µðŸ‡¹ Portugal</option>
                                <option value="NZ">ðŸ‡³ðŸ‡¿ New Zealand</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- City Selector -->
                    <div class="md:col-span-3">
                        <label class="block text-sm text-gray-400 mb-2">City</label>
                        <div class="relative">
                            <i class="fas fa-map-marker-alt absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                            <select id="citySelect" class="select-styled w-full bg-gray-900/50 border border-gray-700 rounded-xl py-3 pl-12 pr-10 text-white focus:outline-none focus:border-indigo-500 transition-colors cursor-pointer">
                                <option value="">All Cities</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Search Button -->
                    <div class="md:col-span-2 flex items-end">
                        <button type="submit" class="btn-primary w-full py-3 rounded-xl font-semibold flex items-center justify-center gap-2">
                            <i class="fas fa-search"></i>
                            Search
                        </button>
                    </div>
                </div>
                
                <!-- Quick Filters Row -->
                <div class="flex items-center justify-between flex-wrap gap-3 pt-4 border-t border-gray-800">
                    <div class="flex items-center gap-2 flex-wrap">
                        <button type="button" id="filtersBtn" class="flex items-center gap-2 px-4 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-sm text-gray-300 hover:bg-gray-700/50 transition-colors">
                            <i class="fas fa-sliders-h"></i>
                            Filters
                            <span id="filterCount" class="hidden bg-indigo-500 text-white text-xs px-2 py-0.5 rounded-full">0</span>
                            <i class="fas fa-chevron-down text-xs transition-transform" id="filtersIcon"></i>
                        </button>
                        <button type="button" id="clearFilters" class="hidden items-center gap-1 px-3 py-2 text-sm text-gray-400 hover:text-white transition-colors">
                            <i class="fas fa-times"></i>
                            Clear
                        </button>
                        
                        <!-- Remote Toggle -->
                        <button type="button" id="remoteToggle" class="remote-toggle flex items-center gap-2 px-3 py-2 bg-gray-800/50 border border-gray-700 rounded-lg text-sm text-gray-400 hover:bg-gray-700/50 transition-colors">
                            <i class="fas fa-wifi"></i>
                            Remote Only
                        </button>
                    </div>
                    
                    <!-- Quick Filter Chips -->
                    <div class="flex items-center gap-2 flex-wrap">
                        <button type="button" class="quick-filter filter-chip px-3 py-1.5 text-xs border border-gray-700 rounded-full text-gray-400" data-filter="remote">
                            Remote
                        </button>
                        <button type="button" class="quick-filter filter-chip px-3 py-1.5 text-xs border border-gray-700 rounded-full text-gray-400" data-filter="full-time">
                            Full-time
                        </button>
                        <button type="button" class="quick-filter filter-chip px-3 py-1.5 text-xs border border-gray-700 rounded-full text-gray-400" data-filter="entry">
                            Entry Level
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <!-- Ausbildung Prompt (for Germany/Austria/Switzerland) -->
        <div id="ausbildungPrompt" class="hidden glass-card rounded-xl p-4 mb-4 bg-green-500/10 border-green-500/25">
            <div class="flex items-center justify-between flex-wrap gap-3">
                <div class="flex items-center gap-3">
                    <i class="fas fa-graduation-cap text-green-400 text-lg"></i>
                    <span class="text-white text-sm">
                        Looking for <strong class="text-green-400">Ausbildung</strong> in <span id="ausbildungCountry">Germany</span>?
                    </span>
                </div>
                <div class="flex gap-2">
                    <button id="ausbildungYes" class="px-3 py-1.5 bg-green-500/30 border border-green-500/50 rounded-md text-xs text-green-300 hover:bg-green-500/40 transition-colors">
                        Yes
                    </button>
                    <button id="ausbildungNo" class="px-3 py-1.5 bg-white/5 border border-white/10 rounded-md text-xs text-gray-400 hover:bg-white/10 transition-colors">
                        No
                    </button>
                </div>
            </div>
        </div>

        <!-- Ausbildung Mode Panel -->
        <div id="ausbildungPanel" class="hidden glass-card rounded-xl p-4 mb-4 bg-green-500/8 border-green-500/25">
            <div class="flex items-center justify-between flex-wrap gap-3 mb-4">
                <div class="flex items-center gap-2">
                    <i class="fas fa-graduation-cap text-green-400"></i>
                    <span class="font-semibold text-green-300 text-sm">Ausbildung Mode ðŸ‡©ðŸ‡ª</span>
                </div>
                <button id="switchToJobs" class="flex items-center gap-1.5 px-3 py-1.5 bg-white/5 border border-white/10 rounded-md text-xs text-gray-400 hover:bg-white/10 transition-colors">
                    <i class="fas fa-briefcase"></i>
                    Switch to Jobs
                </button>
            </div>
            <div class="flex flex-wrap gap-3">
                <select id="ausbildungField" class="flex-1 min-w-[150px] bg-gray-900/80 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-green-500">
                    <option value="">All Fields</option>
                    <option value="kaufmaennisch">Commercial/Business</option>
                    <option value="it">IT & Computer Science</option>
                    <option value="handwerk">Crafts & Technical</option>
                    <option value="gesundheit">Healthcare & Nursing</option>
                    <option value="gastronomie">Gastronomy & Hotel</option>
                    <option value="einzelhandel">Retail & Sales</option>
                    <option value="industrie">Industry & Production</option>
                    <option value="logistik">Logistics & Transport</option>
                    <option value="elektro">Electrical & Electronics</option>
                    <option value="bau">Construction & Architecture</option>
                    <option value="medien">Media & Design</option>
                    <option value="banken">Banking & Insurance</option>
                </select>
                <select id="ausbildungYear" class="min-w-[100px] bg-gray-900/80 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-green-500">
                    <option value="">Any Year</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                </select>
                <select id="ausbildungCity" class="flex-1 min-w-[120px] bg-gray-900/80 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-green-500">
                    <option value="">All Cities</option>
                    <option value="Berlin">Berlin</option>
                    <option value="Hamburg">Hamburg</option>
                    <option value="MÃ¼nchen">MÃ¼nchen</option>
                    <option value="KÃ¶ln">KÃ¶ln</option>
                    <option value="Frankfurt">Frankfurt</option>
                    <option value="Stuttgart">Stuttgart</option>
                    <option value="DÃ¼sseldorf">DÃ¼sseldorf</option>
                    <option value="Leipzig">Leipzig</option>
                    <option value="Dortmund">Dortmund</option>
                    <option value="Essen">Essen</option>
                    <option value="Bremen">Bremen</option>
                    <option value="Dresden">Dresden</option>
                    <option value="Hannover">Hannover</option>
                    <option value="NÃ¼rnberg">NÃ¼rnberg</option>
                </select>
            </div>
        </div>

        <!-- Advanced Filters Panel -->
        <div id="advancedFilters" class="hidden glass-card rounded-2xl p-6 mb-4">
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Job Sources -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2">
                        <i class="fas fa-globe text-indigo-400"></i>
                        Job Sources
                    </h3>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="source-filter accent-indigo-500" value="all" checked>
                            <span>All Sources</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="source-filter accent-indigo-500" value="remoteok">
                            <span>Remote OK</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="source-filter accent-indigo-500" value="adzuna">
                            <span>Adzuna</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="source-filter accent-indigo-500" value="linkedin">
                            <span>LinkedIn</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="source-filter accent-indigo-500" value="themuse">
                            <span>The Muse</span>
                        </label>
                    </div>
                </div>
                
                <!-- Job Type -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2">
                        <i class="fas fa-briefcase text-indigo-400"></i>
                        Job Type
                    </h3>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="type-filter accent-indigo-500" value="full-time">
                            <span>Full-time</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="type-filter accent-indigo-500" value="part-time">
                            <span>Part-time</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="type-filter accent-indigo-500" value="contract">
                            <span>Contract</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="type-filter accent-indigo-500" value="internship">
                            <span>Internship</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="type-filter accent-indigo-500" value="ausbildung">
                            <span>Ausbildung</span>
                        </label>
                    </div>
                </div>
                
                <!-- Experience Level -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2">
                        <i class="fas fa-chart-line text-indigo-400"></i>
                        Experience Level
                    </h3>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="exp-filter accent-indigo-500" value="entry">
                            <span>Entry Level</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="exp-filter accent-indigo-500" value="mid">
                            <span>Mid-Level</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="exp-filter accent-indigo-500" value="senior">
                            <span>Senior</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="exp-filter accent-indigo-500" value="lead">
                            <span>Lead / Manager</span>
                        </label>
                    </div>
                </div>
                
                <!-- Salary Range -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2">
                        <i class="fas fa-dollar-sign text-indigo-400"></i>
                        Salary Range
                    </h3>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="salary-filter accent-indigo-500" value="50k">
                            <span>$50k+</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="salary-filter accent-indigo-500" value="75k">
                            <span>$75k+</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="salary-filter accent-indigo-500" value="100k">
                            <span>$100k+</span>
                        </label>
                        <label class="flex items-center gap-2 text-sm text-gray-400 cursor-pointer hover:text-white">
                            <input type="checkbox" class="salary-filter accent-indigo-500" value="150k">
                            <span>$150k+</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Header -->
        <div class="flex items-center justify-between mb-4 flex-wrap gap-3">
            <p class="text-gray-400" id="resultsInfo">
                <span class="text-white font-semibold" id="totalJobs">0</span> jobs found
                <span class="text-gray-500" id="sourcesUsed"></span>
            </p>
            <div class="flex items-center gap-3">
                <select id="sortBy" class="bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-2 text-sm text-gray-300 focus:outline-none focus:border-indigo-500">
                    <option value="relevant">Most Relevant</option>
                    <option value="newest">Newest First</option>
                    <option value="salaryHigh">Salary: High to Low</option>
                    <option value="salaryLow">Salary: Low to High</option>
                </select>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="hidden">
            <!-- Progress Bar -->
            <div class="glass-card rounded-xl p-4 mb-6">
                <div class="h-2 bg-gray-800 rounded-full overflow-hidden mb-2">
                    <div id="progressBar" class="progress-bar h-full rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-sm">
                    <span class="text-indigo-400" id="progressPercent">0%</span>
                    <span class="text-gray-500" id="progressStage">Initializing search...</span>
                </div>
            </div>
            
            <!-- Skeleton Cards -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="glass-card rounded-xl p-5">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-xl skeleton"></div>
                        <div class="flex-1">
                            <div class="h-5 w-3/4 skeleton rounded mb-2"></div>
                            <div class="h-4 w-1/2 skeleton rounded"></div>
                        </div>
                    </div>
                    <div class="h-16 skeleton rounded mb-4"></div>
                    <div class="flex gap-2">
                        <div class="h-6 w-16 skeleton rounded-full"></div>
                        <div class="h-6 w-20 skeleton rounded-full"></div>
                        <div class="h-6 w-14 skeleton rounded-full"></div>
                    </div>
                </div>
                <div class="glass-card rounded-xl p-5">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-xl skeleton"></div>
                        <div class="flex-1">
                            <div class="h-5 w-3/4 skeleton rounded mb-2"></div>
                            <div class="h-4 w-1/2 skeleton rounded"></div>
                        </div>
                    </div>
                    <div class="h-16 skeleton rounded mb-4"></div>
                    <div class="flex gap-2">
                        <div class="h-6 w-16 skeleton rounded-full"></div>
                        <div class="h-6 w-20 skeleton rounded-full"></div>
                        <div class="h-6 w-14 skeleton rounded-full"></div>
                    </div>
                </div>
                <div class="glass-card rounded-xl p-5 hidden lg:block">
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-xl skeleton"></div>
                        <div class="flex-1">
                            <div class="h-5 w-3/4 skeleton rounded mb-2"></div>
                            <div class="h-4 w-1/2 skeleton rounded"></div>
                        </div>
                    </div>
                    <div class="h-16 skeleton rounded mb-4"></div>
                    <div class="flex gap-2">
                        <div class="h-6 w-16 skeleton rounded-full"></div>
                        <div class="h-6 w-20 skeleton rounded-full"></div>
                        <div class="h-6 w-14 skeleton rounded-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden glass-card rounded-2xl p-12 text-center">
            <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-300 mb-2">No jobs found</h3>
            <p class="text-gray-500 mb-6">Try adjusting your search criteria or filters</p>
            <button id="clearAllBtn" class="btn-primary px-6 py-3 rounded-xl font-semibold">
                Clear filters and search again
            </button>
        </div>

        <!-- Jobs Grid -->
        <div id="jobsGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8"></div>

        <!-- Pagination -->
        <div id="pagination" class="hidden flex items-center justify-center gap-2 flex-wrap"></div>
    </div>

    <!-- Job Detail Modal -->
    <div id="jobModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="glass-card rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
            <div class="p-6 border-b border-gray-800 flex items-start justify-between">
                <div class="flex items-start gap-4">
                    <div id="modalLogo" class="w-16 h-16 rounded-xl flex items-center justify-center text-2xl font-bold text-white"></div>
                    <div>
                        <h2 id="modalTitle" class="text-xl font-bold text-white mb-1"></h2>
                        <p id="modalCompany" class="text-gray-400"></p>
                    </div>
                </div>
                <button id="closeModal" class="text-gray-500 hover:text-white transition-colors p-2">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[60vh] scrollbar-thin">
                <div class="flex flex-wrap gap-3 mb-6">
                    <span id="modalLocation" class="flex items-center gap-2 text-sm text-gray-400">
                        <i class="fas fa-map-marker-alt"></i>
                        <span></span>
                    </span>
                    <span id="modalSalary" class="flex items-center gap-2 text-sm text-green-400">
                        <i class="fas fa-dollar-sign"></i>
                        <span></span>
                    </span>
                    <span id="modalType" class="flex items-center gap-2 text-sm text-indigo-400">
                        <i class="fas fa-briefcase"></i>
                        <span></span>
                    </span>
                </div>
                <div id="modalDescription" class="text-gray-300 text-sm leading-relaxed mb-6"></div>
                <div id="modalTags" class="flex flex-wrap gap-2 mb-6"></div>
            </div>
            <div class="p-6 border-t border-gray-800 flex items-center justify-between">
                <span id="modalPosted" class="text-sm text-gray-500"></span>
                <div class="flex gap-3">
                    <button id="modalSaveBtn" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-gray-300 hover:bg-gray-700 transition-colors flex items-center gap-2">
                        <i class="far fa-bookmark"></i>
                        Save
                    </button>
                    <a id="modalApplyBtn" href="#" target="_blank" class="btn-primary px-6 py-2 rounded-lg font-semibold flex items-center gap-2">
                        Apply Now
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Country and City Data
        const COUNTRIES_DATA = {
            'US': { 
                name: 'United States', 
                flag: 'ðŸ‡ºðŸ‡¸',
                cities: ['New York', 'San Francisco', 'Los Angeles', 'Chicago', 'Seattle', 'Boston', 'Austin', 'Denver', 'Atlanta', 'Miami', 'Washington DC', 'San Jose', 'Portland', 'San Diego', 'Phoenix']
            },
            'GB': { 
                name: 'United Kingdom', 
                flag: 'ðŸ‡¬ðŸ‡§',
                cities: ['London', 'Manchester', 'Birmingham', 'Edinburgh', 'Glasgow', 'Bristol', 'Leeds', 'Liverpool', 'Cambridge', 'Oxford']
            },
            'DE': { 
                name: 'Germany', 
                flag: 'ðŸ‡©ðŸ‡ª',
                supportsAusbildung: true,
                cities: ['Berlin', 'Hamburg', 'MÃ¼nchen', 'KÃ¶ln', 'Frankfurt', 'Stuttgart', 'DÃ¼sseldorf', 'Leipzig', 'Dortmund', 'Essen', 'Bremen', 'Dresden', 'Hannover', 'NÃ¼rnberg']
            },
            'CA': { 
                name: 'Canada', 
                flag: 'ðŸ‡¨ðŸ‡¦',
                cities: ['Toronto', 'Vancouver', 'Montreal', 'Calgary', 'Ottawa', 'Edmonton', 'Winnipeg', 'Quebec City']
            },
            'AU': { 
                name: 'Australia', 
                flag: 'ðŸ‡¦ðŸ‡º',
                cities: ['Sydney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaide', 'Canberra', 'Gold Coast']
            },
            'FR': { 
                name: 'France', 
                flag: 'ðŸ‡«ðŸ‡·',
                cities: ['Paris', 'Lyon', 'Marseille', 'Toulouse', 'Bordeaux', 'Nice', 'Nantes', 'Lille']
            },
            'NL': { 
                name: 'Netherlands', 
                flag: 'ðŸ‡³ðŸ‡±',
                cities: ['Amsterdam', 'Rotterdam', 'The Hague', 'Utrecht', 'Eindhoven', 'Groningen']
            },
            'ES': { 
                name: 'Spain', 
                flag: 'ðŸ‡ªðŸ‡¸',
                cities: ['Madrid', 'Barcelona', 'Valencia', 'Seville', 'Malaga', 'Bilbao']
            },
            'IT': { 
                name: 'Italy', 
                flag: 'ðŸ‡®ðŸ‡¹',
                cities: ['Milan', 'Rome', 'Turin', 'Florence', 'Bologna', 'Naples']
            },
            'SE': { 
                name: 'Sweden', 
                flag: 'ðŸ‡¸ðŸ‡ª',
                cities: ['Stockholm', 'Gothenburg', 'MalmÃ¶', 'Uppsala']
            },
            'CH': { 
                name: 'Switzerland', 
                flag: 'ðŸ‡¨ðŸ‡­',
                supportsAusbildung: true,
                cities: ['Zurich', 'Geneva', 'Basel', 'Bern', 'Lausanne']
            },
            'AT': { 
                name: 'Austria', 
                flag: 'ðŸ‡¦ðŸ‡¹',
                supportsAusbildung: true,
                cities: ['Vienna', 'Graz', 'Linz', 'Salzburg', 'Innsbruck']
            },
            'IE': { 
                name: 'Ireland', 
                flag: 'ðŸ‡®ðŸ‡ª',
                cities: ['Dublin', 'Cork', 'Galway', 'Limerick']
            },
            'SG': { 
                name: 'Singapore', 
                flag: 'ðŸ‡¸ðŸ‡¬',
                cities: ['Singapore']
            },
            'JP': { 
                name: 'Japan', 
                flag: 'ðŸ‡¯ðŸ‡µ',
                cities: ['Tokyo', 'Osaka', 'Yokohama', 'Nagoya', 'Kyoto', 'Fukuoka']
            },
            'IN': { 
                name: 'India', 
                flag: 'ðŸ‡®ðŸ‡³',
                cities: ['Bangalore', 'Mumbai', 'Delhi', 'Hyderabad', 'Chennai', 'Pune', 'Kolkata']
            },
            'BR': { 
                name: 'Brazil', 
                flag: 'ðŸ‡§ðŸ‡·',
                cities: ['SÃ£o Paulo', 'Rio de Janeiro', 'Belo Horizonte', 'BrasÃ­lia', 'Curitiba']
            },
            'PL': { 
                name: 'Poland', 
                flag: 'ðŸ‡µðŸ‡±',
                cities: ['Warsaw', 'Krakow', 'Wroclaw', 'Gdansk', 'Poznan', 'Lodz']
            },
            'PT': { 
                name: 'Portugal', 
                flag: 'ðŸ‡µðŸ‡¹',
                cities: ['Lisbon', 'Porto', 'Braga', 'Faro']
            },
            'NZ': { 
                name: 'New Zealand', 
                flag: 'ðŸ‡³ðŸ‡¿',
                cities: ['Auckland', 'Wellington', 'Christchurch', 'Hamilton']
            }
        };

        // Mock job data with country codes
        const MOCK_JOBS = [
            {
                id: 'job-1',
                title: 'Senior Frontend Developer',
                company: 'TechCorp Inc.',
                location: 'San Francisco, CA',
                country: 'US',
                city: 'San Francisco',
                salary: '$150k - $200k',
                type: 'Full-time',
                experience: 'senior',
                description: 'We are looking for a Senior Frontend Developer to join our dynamic team. You will be responsible for building user-facing features using React and TypeScript. The ideal candidate has 5+ years of experience with modern JavaScript frameworks and a passion for creating beautiful, performant web applications.',
                tags: ['React', 'TypeScript', 'Next.js', 'TailwindCSS'],
                postedAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: true,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-2',
                title: 'Backend Engineer',
                company: 'StartupXYZ',
                location: 'New York, NY',
                country: 'US',
                city: 'New York',
                salary: '$120k - $160k',
                type: 'Full-time',
                experience: 'mid',
                description: 'Join our growing engineering team as a Backend Engineer. You will design and implement scalable APIs and microservices using Node.js and Python. We value clean code, thorough testing, and collaborative problem-solving.',
                tags: ['Node.js', 'Python', 'PostgreSQL', 'AWS'],
                postedAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                source: 'remoteok',
                featured: false,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-3',
                title: 'Full Stack Developer',
                company: 'InnovateLabs',
                location: 'Remote',
                country: '',
                city: '',
                salary: '$100k - $140k',
                type: 'Full-time',
                experience: 'mid',
                description: 'We are seeking a Full Stack Developer who can work across the entire stack. Experience with React on the frontend and Node.js/Express on the backend is required. This is a fully remote position with flexible hours.',
                tags: ['React', 'Node.js', 'MongoDB', 'GraphQL'],
                postedAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                source: 'adzuna',
                featured: false,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-4',
                title: 'Junior Software Engineer',
                company: 'GrowthTech',
                location: 'Austin, TX',
                country: 'US',
                city: 'Austin',
                salary: '$70k - $90k',
                type: 'Full-time',
                experience: 'entry',
                description: 'Great opportunity for a Junior Software Engineer to join a supportive team. You will work on real projects while learning from experienced mentors. Recent graduates with strong fundamentals in computer science are encouraged to apply.',
                tags: ['Java', 'Spring Boot', 'React', 'SQL'],
                postedAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: false,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-5',
                title: 'DevOps Engineer',
                company: 'CloudScale',
                location: 'London, UK',
                country: 'GB',
                city: 'London',
                salary: 'Â£80k - Â£110k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Looking for a DevOps Engineer to help us scale our infrastructure. You will work with Kubernetes, Terraform, and AWS to build and maintain our cloud infrastructure. Strong experience with CI/CD pipelines is essential.',
                tags: ['Kubernetes', 'Terraform', 'AWS', 'Docker'],
                postedAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
                source: 'remoteok',
                featured: true,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-6',
                title: 'UX/UI Designer',
                company: 'DesignStudio',
                location: 'Berlin, Germany',
                country: 'DE',
                city: 'Berlin',
                salary: 'â‚¬60k - â‚¬85k',
                type: 'Full-time',
                experience: 'mid',
                description: 'We are looking for a creative UX/UI Designer to join our product team. You will create user-centered designs for web and mobile applications. Experience with Figma and a strong portfolio are required.',
                tags: ['Figma', 'UI Design', 'UX Research', 'Prototyping'],
                postedAt: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000),
                source: 'adzuna',
                featured: false,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-7',
                title: 'Data Scientist',
                company: 'DataDriven',
                location: 'Toronto, Canada',
                country: 'CA',
                city: 'Toronto',
                salary: 'CAD $110k - $150k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Join our data science team to build machine learning models that drive business decisions. You will work with large datasets and collaborate with product and engineering teams. PhD or Masters in a quantitative field preferred.',
                tags: ['Python', 'TensorFlow', 'SQL', 'Machine Learning'],
                postedAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: false,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-8',
                title: 'Mobile Developer (iOS)',
                company: 'AppWorks',
                location: 'Remote',
                country: '',
                city: '',
                salary: '$110k - $150k',
                type: 'Full-time',
                experience: 'mid',
                description: 'We need an experienced iOS Developer to build and maintain our mobile applications. Proficiency in Swift and SwiftUI is required. Experience with React Native is a plus.',
                tags: ['Swift', 'SwiftUI', 'iOS', 'Xcode'],
                postedAt: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000),
                source: 'remoteok',
                featured: false,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-9',
                title: 'Product Manager',
                company: 'ProductHub',
                location: 'Amsterdam, Netherlands',
                country: 'NL',
                city: 'Amsterdam',
                salary: 'â‚¬75k - â‚¬100k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Looking for a Product Manager to lead our core product initiatives. You will define product strategy, work closely with engineering, and drive feature development. 5+ years of product management experience required.',
                tags: ['Product Strategy', 'Agile', 'Analytics', 'Leadership'],
                postedAt: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: true,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-10',
                title: 'QA Engineer',
                company: 'QualityFirst',
                location: 'Sydney, Australia',
                country: 'AU',
                city: 'Sydney',
                salary: 'AUD $90k - $120k',
                type: 'Full-time',
                experience: 'mid',
                description: 'Join our QA team to ensure the quality of our software products. You will design test plans, write automated tests, and work closely with developers. Experience with Selenium and Cypress is preferred.',
                tags: ['Selenium', 'Cypress', 'Jest', 'Test Automation'],
                postedAt: new Date(Date.now() - 8 * 24 * 60 * 60 * 1000),
                source: 'adzuna',
                featured: false,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-11',
                title: 'Cloud Architect',
                company: 'CloudNative Solutions',
                location: 'Remote',
                country: '',
                city: '',
                salary: '$170k - $220k',
                type: 'Full-time',
                experience: 'lead',
                description: 'We are seeking a Cloud Architect to design and implement our cloud infrastructure strategy. You will lead the migration to cloud-native architecture and mentor junior engineers. AWS or GCP certification required.',
                tags: ['AWS', 'GCP', 'Architecture', 'Microservices'],
                postedAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: true,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-12',
                title: 'Ausbildung Fachinformatiker',
                company: 'TechStart GmbH',
                location: 'MÃ¼nchen, Germany',
                country: 'DE',
                city: 'MÃ¼nchen',
                salary: 'â‚¬1,100/month',
                type: 'Ausbildung',
                experience: 'entry',
                description: 'Start your career in IT with an Ausbildung as Fachinformatiker. You will learn software development, IT systems, and gain practical experience in a modern tech company. Duration: 3 years.',
                tags: ['Ausbildung', 'IT', 'Software Development', 'German'],
                postedAt: new Date(Date.now() - 12 * 24 * 60 * 60 * 1000),
                source: 'ausbildung',
                featured: false,
                remote: false,
                isAusbildung: true,
                ausbildungDetails: {
                    duration: '3 years',
                    startDate: 'September 2025',
                    requiredEducation: ['Abitur', 'Fachabitur']
                },
                applyUrl: '#'
            },
            {
                id: 'job-13',
                title: 'Security Engineer',
                company: 'SecureNet',
                location: 'Paris, France',
                country: 'FR',
                city: 'Paris',
                salary: 'â‚¬65k - â‚¬90k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Join our security team to protect our infrastructure and applications. You will conduct security assessments, implement security controls, and respond to incidents. CISSP or similar certification preferred.',
                tags: ['Security', 'Penetration Testing', 'SIEM', 'Compliance'],
                postedAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                source: 'linkedin',
                featured: false,
                remote: false,
                applyUrl: '#'
            },
            {
                id: 'job-14',
                title: 'Machine Learning Engineer',
                company: 'AI Solutions',
                location: 'Remote',
                country: '',
                city: '',
                salary: '$150k - $200k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Looking for a Machine Learning Engineer to build and deploy ML models at scale. You will work on NLP, computer vision, and recommendation systems. Strong Python skills and experience with PyTorch or TensorFlow required.',
                tags: ['Python', 'PyTorch', 'MLOps', 'Deep Learning'],
                postedAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                source: 'remoteok',
                featured: true,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-15',
                title: 'Technical Writer',
                company: 'DocuTech',
                location: 'Dublin, Ireland',
                country: 'IE',
                city: 'Dublin',
                salary: 'â‚¬55k - â‚¬75k',
                type: 'Contract',
                experience: 'mid',
                description: 'We need a Technical Writer to create documentation for our developer tools. You will write API documentation, tutorials, and guides. Experience with developer documentation and Markdown is required.',
                tags: ['Technical Writing', 'API Docs', 'Markdown', 'Git'],
                postedAt: new Date(Date.now() - 9 * 24 * 60 * 60 * 1000),
                source: 'adzuna',
                featured: false,
                remote: true,
                applyUrl: '#'
            },
            {
                id: 'job-16',
                title: 'Site Reliability Engineer',
                company: 'ReliableSystems',
                location: 'Singapore',
                country: 'SG',
                city: 'Singapore',
                salary: 'SGD $100k - $140k',
                type: 'Full-time',
                experience: 'senior',
                description: 'Join our SRE team to ensure the reliability and performance of our services. You will build monitoring systems, respond to incidents, and improve our infrastructure. Experience with observability tools required.',
                tags: ['SRE', 'Prometheus', 'Grafana', 'Linux'],
                postedAt: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000),
                source: 'themuse',
                featured: false,
                remote: false,
                applyUrl: '#'
            }
        ];

        // User preferences (simulated)
        let userPreferences = JSON.parse(localStorage.getItem('userPreferences')) || null;
        let hasCV = localStorage.getItem('hasCV') === 'true';
        let usingPreferences = false;

        // State
        let allJobs = [...MOCK_JOBS];
        let filteredJobs = [...MOCK_JOBS];
        let currentPage = 1;
        let jobsPerPage = 9;
        let savedJobs = JSON.parse(localStorage.getItem('savedJobs') || '[]');
        let selectedCountry = '';
        let selectedCity = '';
        let isRemoteOnly = false;
        let isAusbildungMode = false;
        let ausbildungPromptDismissed = false;
        let activeFilters = {
            remote: false,
            'full-time': false,
            entry: false,
            sources: ['all'],
            types: [],
            experience: [],
            salary: []
        };
        let currentJobId = null;

        // DOM Elements
        const searchForm = document.getElementById('searchForm');
        const searchQuery = document.getElementById('searchQuery');
        const countrySelect = document.getElementById('countrySelect');
        const citySelect = document.getElementById('citySelect');
        const remoteToggle = document.getElementById('remoteToggle');
        const filtersBtn = document.getElementById('filtersBtn');
        const advancedFilters = document.getElementById('advancedFilters');
        const filtersIcon = document.getElementById('filtersIcon');
        const filterCount = document.getElementById('filterCount');
        const clearFilters = document.getElementById('clearFilters');
        const clearAllBtn = document.getElementById('clearAllBtn');
        const loadingState = document.getElementById('loadingState');
        const emptyState = document.getElementById('emptyState');
        const jobsGrid = document.getElementById('jobsGrid');
        const pagination = document.getElementById('pagination');
        const totalJobsEl = document.getElementById('totalJobs');
        const sourcesUsed = document.getElementById('sourcesUsed');
        const sortBy = document.getElementById('sortBy');
        const progressBar = document.getElementById('progressBar');
        const progressPercent = document.getElementById('progressPercent');
        const progressStage = document.getElementById('progressStage');
        const jobModal = document.getElementById('jobModal');
        const closeModal = document.getElementById('closeModal');
        
        // Notification elements
        const notificationBar = document.getElementById('notificationBar');
        const cvBadge = document.getElementById('cvBadge');
        const preferencesBadge = document.getElementById('preferencesBadge');
        const preferencesBar = document.getElementById('preferencesBar');
        const usingPreferencesIndicator = document.getElementById('usingPreferencesIndicator');
        const savedPreferencesIndicator = document.getElementById('savedPreferencesIndicator');
        const clearPreferencesBtn = document.getElementById('clearPreferencesBtn');
        const usePreferencesBtn = document.getElementById('usePreferencesBtn');
        
        // Ausbildung elements
        const ausbildungPrompt = document.getElementById('ausbildungPrompt');
        const ausbildungPanel = document.getElementById('ausbildungPanel');
        const ausbildungCountry = document.getElementById('ausbildungCountry');
        const ausbildungYes = document.getElementById('ausbildungYes');
        const ausbildungNo = document.getElementById('ausbildungNo');
        const switchToJobs = document.getElementById('switchToJobs');

        // Initialize notifications
        function initNotifications() {
            // Update CV badge visibility
            if (hasCV) {
                cvBadge.classList.add('hidden');
            }
            
            // Update preferences badge visibility
            if (userPreferences) {
                preferencesBadge.classList.add('hidden');
                showPreferencesBar();
            }
            
            // Hide notification bar if all badges are hidden
            if (hasCV && userPreferences) {
                notificationBar.classList.add('hidden');
            }
        }

        // Show preferences bar
        function showPreferencesBar() {
            if (!userPreferences) return;
            
            preferencesBar.classList.remove('hidden');
            
            const prefTitles = document.getElementById('prefTitles');
            const prefLocation = document.getElementById('prefLocation');
            const savedPrefTitles = document.getElementById('savedPrefTitles');
            const savedPrefLocation = document.getElementById('savedPrefLocation');
            
            const titles = userPreferences.titles?.slice(0, 2).join(', ') || 'Developer';
            const location = userPreferences.country ? COUNTRIES_DATA[userPreferences.country]?.name || userPreferences.country : 'Remote';
            
            prefTitles.textContent = titles;
            prefLocation.textContent = location;
            savedPrefTitles.textContent = titles;
            savedPrefLocation.textContent = location;
            
            updatePreferencesIndicators();
        }

        // Update preferences indicators
        function updatePreferencesIndicators() {
            if (usingPreferences) {
                usingPreferencesIndicator.classList.remove('hidden');
                usingPreferencesIndicator.classList.add('flex');
                savedPreferencesIndicator.classList.add('hidden');
                savedPreferencesIndicator.classList.remove('flex');
                clearPreferencesBtn.classList.remove('hidden');
                clearPreferencesBtn.classList.add('flex');
                usePreferencesBtn.classList.add('hidden');
                usePreferencesBtn.classList.remove('flex');
            } else {
                usingPreferencesIndicator.classList.add('hidden');
                usingPreferencesIndicator.classList.remove('flex');
                savedPreferencesIndicator.classList.remove('hidden');
                savedPreferencesIndicator.classList.add('flex');
                clearPreferencesBtn.classList.add('hidden');
                clearPreferencesBtn.classList.remove('flex');
                usePreferencesBtn.classList.remove('hidden');
                usePreferencesBtn.classList.add('flex');
            }
        }

        // Search with preferences
        function searchWithPreferences() {
            if (!userPreferences) return;
            
            usingPreferences = true;
            updatePreferencesIndicators();
            
            // Apply preferences to search
            searchQuery.value = userPreferences.titles?.[0] || '';
            if (userPreferences.country) {
                countrySelect.value = userPreferences.country;
                updateCityOptions();
            }
            if (userPreferences.remote) {
                isRemoteOnly = true;
                remoteToggle.classList.add('active');
            }
            
            simulateSearch();
        }

        // Clear preferences from search
        function clearPreferencesFromSearch() {
            usingPreferences = false;
            updatePreferencesIndicators();
            
            searchQuery.value = '';
            countrySelect.value = '';
            citySelect.value = '';
            updateCityOptions();
            isRemoteOnly = false;
            remoteToggle.classList.remove('active');
        }

        // Update city options based on selected country
        function updateCityOptions() {
            const country = countrySelect.value;
            selectedCountry = country;
            
            citySelect.innerHTML = '<option value="">All Cities</option>';
            
            if (country && COUNTRIES_DATA[country]) {
                const cities = COUNTRIES_DATA[country].cities;
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
                
                // Check for Ausbildung support
                if (COUNTRIES_DATA[country].supportsAusbildung && !isAusbildungMode && !ausbildungPromptDismissed) {
                    ausbildungCountry.textContent = COUNTRIES_DATA[country].name;
                    ausbildungPrompt.classList.remove('hidden');
                } else {
                    ausbildungPrompt.classList.add('hidden');
                }
            } else {
                ausbildungPrompt.classList.add('hidden');
            }
        }

        // Generate company colors
        function generateCompanyColors(name) {
            const hash = (name || 'Unknown').split('').reduce((acc, char) => 
                char.charCodeAt(0) + ((acc << 5) - acc), 0
            );
            const hue1 = Math.abs(hash % 360);
            const hue2 = (hue1 + 30) % 360;
            return [`hsl(${hue1}, 70%, 50%)`, `hsl(${hue2}, 70%, 40%)`];
        }

        // Format date
        function formatPostedDate(date) {
            if (!date) return 'Recently';
            const now = new Date();
            const diffMs = now - new Date(date);
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffHours / 24);
            
            if (diffHours < 1) return 'Just now';
            if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} week${Math.floor(diffDays / 7) > 1 ? 's' : ''} ago`;
            return `${Math.floor(diffDays / 30)} month${Math.floor(diffDays / 30) > 1 ? 's' : ''} ago`;
        }

        // Get source name
        function getSourceName(source) {
            const names = {
                'linkedin': 'LinkedIn',
                'remoteok': 'Remote OK',
                'adzuna': 'Adzuna',
                'themuse': 'The Muse',
                'ausbildung': 'Ausbildung.de',
                'all': 'All Sources'
            };
            return names[source] || source;
        }

        // Render job card
        function renderJobCard(job) {
            const colors = generateCompanyColors(job.company);
            const isSaved = savedJobs.includes(job.id);
            
            return `
                <div class="job-card glass-card rounded-xl p-5 cursor-pointer relative" data-job-id="${job.id}">
                    ${job.featured ? `
                        <div class="featured-badge absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-semibold text-white flex items-center gap-1">
                            <i class="fas fa-star text-xs"></i>
                            Featured
                        </div>
                    ` : ''}
                    
                    <div class="flex items-start gap-4 mb-4">
                        <div class="w-12 h-12 rounded-xl flex items-center justify-center text-lg font-bold text-white flex-shrink-0"
                            style="background: linear-gradient(135deg, ${colors[0]}, ${colors[1]})">
                            ${job.company[0].toUpperCase()}
                        </div>
                        <div class="min-w-0 flex-1">
                            <h3 class="font-semibold text-white truncate pr-16">${job.title}</h3>
                            <p class="text-sm text-gray-400 truncate">${job.company}</p>
                        </div>
                    </div>
                    
                    <p class="text-sm text-gray-400 mb-4 line-clamp-2" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                        ${job.description.substring(0, 120)}...
                    </p>
                    
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${job.tags.slice(0, 3).map(tag => `
                            <span class="px-2 py-1 bg-gray-800/50 border border-gray-700 rounded-full text-xs text-gray-400">${tag}</span>
                        `).join('')}
                        ${job.tags.length > 3 ? `<span class="px-2 py-1 text-xs text-gray-500">+${job.tags.length - 3}</span>` : ''}
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3 text-xs text-gray-500">
                            <span class="flex items-center gap-1">
                                <i class="fas fa-map-marker-alt"></i>
                                ${job.location}
                            </span>
                            ${job.salary ? `
                                <span class="text-green-400">${job.salary}</span>
                            ` : ''}
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-xs text-gray-600">${formatPostedDate(job.postedAt)}</span>
                            <button class="save-btn p-1.5 text-gray-500 hover:text-yellow-400 transition-colors ${isSaved ? 'saved' : ''}" 
                                data-job-id="${job.id}" onclick="event.stopPropagation(); toggleSaveJob('${job.id}')">
                                <i class="${isSaved ? 'fas' : 'far'} fa-bookmark"></i>
                            </button>
                        </div>
                    </div>
                    
                    ${job.isAusbildung ? `
                        <div class="flex items-center gap-2 mt-3 pt-3 border-t border-gray-800 bg-green-500/10 rounded-lg p-2 -mx-2">
                            <i class="fas fa-graduation-cap text-green-400"></i>
                            <span class="text-green-400 text-xs font-semibold">Ausbildung</span>
                            ${job.ausbildungDetails?.duration ? `<span class="text-gray-500 text-xs">â€¢ ${job.ausbildungDetails.duration}</span>` : ''}
                            ${job.ausbildungDetails?.startDate ? `<span class="text-gray-500 text-xs">â€¢ Start: ${job.ausbildungDetails.startDate}</span>` : ''}
                        </div>
                    ` : ''}
                    
                    <div class="mt-3 pt-3 border-t border-gray-800">
                        <span class="platform-badge bg-gray-800 text-gray-500 rounded">
                            via ${getSourceName(job.source)}
                        </span>
                    </div>
                </div>
            `;
        }

        // Render jobs
        function renderJobs() {
            const start = (currentPage - 1) * jobsPerPage;
            const end = start + jobsPerPage;
            const pageJobs = filteredJobs.slice(start, end);
            
            if (pageJobs.length === 0) {
                jobsGrid.innerHTML = '';
                emptyState.classList.remove('hidden');
                pagination.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                jobsGrid.innerHTML = pageJobs.map(job => renderJobCard(job)).join('');
                renderPagination();
                
                // Add click handlers
                document.querySelectorAll('.job-card').forEach(card => {
                    card.addEventListener('click', () => openJobModal(card.dataset.jobId));
                });
            }
            
            totalJobsEl.textContent = filteredJobs.length;
            
            // Show sources used
            const sources = [...new Set(filteredJobs.map(j => j.source))];
            if (sources.length > 0) {
                sourcesUsed.textContent = ` from ${sources.map(s => getSourceName(s)).join(', ')}`;
            } else {
                sourcesUsed.textContent = '';
            }
        }

        // Render pagination
        function renderPagination() {
            const totalPages = Math.ceil(filteredJobs.length / jobsPerPage);
            if (totalPages <= 1) {
                pagination.classList.add('hidden');
                return;
            }
            
            pagination.classList.remove('hidden');
            let html = '';
            
            // Previous button
            html += `
                <button class="px-3 py-2 rounded-lg ${currentPage === 1 ? 'text-gray-600 cursor-not-allowed' : 'text-gray-400 hover:bg-gray-800'} transition-colors"
                    ${currentPage === 1 ? 'disabled' : ''} onclick="changePage(${currentPage - 1})">
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    html += `
                        <button class="w-10 h-10 rounded-lg ${i === currentPage ? 'bg-indigo-600 text-white' : 'text-gray-400 hover:bg-gray-800'} transition-colors"
                            onclick="changePage(${i})">
                            ${i}
                        </button>
                    `;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    html += `<span class="text-gray-600">...</span>`;
                }
            }
            
            // Next button
            html += `
                <button class="px-3 py-2 rounded-lg ${currentPage === totalPages ? 'text-gray-600 cursor-not-allowed' : 'text-gray-400 hover:bg-gray-800'} transition-colors"
                    ${currentPage === totalPages ? 'disabled' : ''} onclick="changePage(${currentPage + 1})">
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            pagination.innerHTML = html;
        }

        // Change page
        function changePage(page) {
            currentPage = page;
            renderJobs();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Filter jobs
        function filterJobs() {
            const query = searchQuery.value.toLowerCase();
            const country = countrySelect.value;
            const city = citySelect.value;
            
            filteredJobs = allJobs.filter(job => {
                // Text search
                const matchesQuery = !query || 
                    job.title.toLowerCase().includes(query) ||
                    job.company.toLowerCase().includes(query) ||
                    job.description.toLowerCase().includes(query) ||
                    job.tags.some(tag => tag.toLowerCase().includes(query));
                
                // Country filter
                const matchesCountry = !country || job.country === country || job.remote;
                
                // City filter
                const matchesCity = !city || job.city === city || job.remote;
                
                // Remote only filter
                const matchesRemoteOnly = !isRemoteOnly || job.remote;
                
                // Quick filters
                const matchesRemote = !activeFilters.remote || job.remote;
                const matchesFullTime = !activeFilters['full-time'] || job.type === 'Full-time';
                const matchesEntry = !activeFilters.entry || job.experience === 'entry';
                
                // Advanced filters
                const matchesType = activeFilters.types.length === 0 || 
                    activeFilters.types.some(t => job.type.toLowerCase().includes(t));
                const matchesExp = activeFilters.experience.length === 0 || 
                    activeFilters.experience.includes(job.experience);
                
                // Ausbildung mode
                const matchesAusbildung = !isAusbildungMode || job.isAusbildung;
                
                return matchesQuery && matchesCountry && matchesCity && matchesRemoteOnly && 
                       matchesRemote && matchesFullTime && matchesEntry && matchesType && 
                       matchesExp && matchesAusbildung;
            });
            
            // Sort
            sortJobs();
            
            currentPage = 1;
            renderJobs();
        }

        // Sort jobs
        function sortJobs() {
            const sortValue = sortBy.value;
            
            filteredJobs.sort((a, b) => {
                if (sortValue === 'newest') {
                    return new Date(b.postedAt) - new Date(a.postedAt);
                } else if (sortValue === 'salaryHigh' || sortValue === 'salaryLow') {
                    const getSalary = (s) => {
                        const match = s?.match(/[\$â‚¬Â£](\d+)k?/);
                        return match ? parseInt(match[1]) * (s.includes('k') ? 1000 : 1) : 0;
                    };
                    const salaryA = getSalary(a.salary);
                    const salaryB = getSalary(b.salary);
                    return sortValue === 'salaryHigh' ? salaryB - salaryA : salaryA - salaryB;
                }
                // Default: featured first, then by date
                if (a.featured !== b.featured) return b.featured - a.featured;
                return new Date(b.postedAt) - new Date(a.postedAt);
            });
        }

        // Update filter count
        function updateFilterCount() {
            let count = 0;
            if (activeFilters.remote) count++;
            if (activeFilters['full-time']) count++;
            if (activeFilters.entry) count++;
            count += activeFilters.types.length;
            count += activeFilters.experience.length;
            count += activeFilters.salary.length;
            if (!activeFilters.sources.includes('all')) count += activeFilters.sources.length;
            
            if (count > 0) {
                filterCount.textContent = count;
                filterCount.classList.remove('hidden');
                clearFilters.classList.remove('hidden');
                clearFilters.classList.add('flex');
            } else {
                filterCount.classList.add('hidden');
                clearFilters.classList.add('hidden');
                clearFilters.classList.remove('flex');
            }
        }

        // Simulate search with progress
        async function simulateSearch() {
            loadingState.classList.remove('hidden');
            jobsGrid.innerHTML = '';
            emptyState.classList.add('hidden');
            pagination.classList.add('hidden');
            
            const stages = [
                { progress: 15, text: 'Connecting to job providers...' },
                { progress: 35, text: 'Searching RemoteOK...' },
                { progress: 50, text: 'Searching Adzuna...' },
                { progress: 65, text: 'Searching LinkedIn...' },
                { progress: 78, text: 'Searching The Muse...' },
                { progress: 88, text: 'Processing results...' },
                { progress: 95, text: 'Finalizing...' },
            ];
            
            for (const stage of stages) {
                await new Promise(resolve => setTimeout(resolve, 200));
                progressBar.style.width = `${stage.progress}%`;
                progressPercent.textContent = `${stage.progress}%`;
                progressStage.textContent = stage.text;
            }
            
            await new Promise(resolve => setTimeout(resolve, 150));
            progressBar.style.width = '100%';
            progressPercent.textContent = '100%';
            progressStage.textContent = 'Complete!';
            
            await new Promise(resolve => setTimeout(resolve, 300));
            loadingState.classList.add('hidden');
            
            filterJobs();
        }

        // Toggle save job
        function toggleSaveJob(jobId) {
            const index = savedJobs.indexOf(jobId);
            if (index > -1) {
                savedJobs.splice(index, 1);
            } else {
                savedJobs.push(jobId);
            }
            localStorage.setItem('savedJobs', JSON.stringify(savedJobs));
            
            // Update UI
            document.querySelectorAll(`.save-btn[data-job-id="${jobId}"]`).forEach(btn => {
                btn.classList.toggle('saved');
                const icon = btn.querySelector('i');
                icon.classList.toggle('fas');
                icon.classList.toggle('far');
            });
            
            // Update modal if open
            if (currentJobId === jobId) {
                const modalSaveBtn = document.getElementById('modalSaveBtn');
                const isSaved = savedJobs.includes(jobId);
                modalSaveBtn.innerHTML = `<i class="${isSaved ? 'fas' : 'far'} fa-bookmark"></i> ${isSaved ? 'Saved' : 'Save'}`;
            }
        }

        // Open job modal
        function openJobModal(jobId) {
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;
            
            currentJobId = jobId;
            const colors = generateCompanyColors(job.company);
            const isSaved = savedJobs.includes(job.id);
            
            document.getElementById('modalLogo').style.background = `linear-gradient(135deg, ${colors[0]}, ${colors[1]})`;
            document.getElementById('modalLogo').textContent = job.company[0].toUpperCase();
            document.getElementById('modalTitle').textContent = job.title;
            document.getElementById('modalCompany').textContent = job.company;
            document.getElementById('modalLocation').querySelector('span').textContent = job.location;
            document.getElementById('modalSalary').querySelector('span').textContent = job.salary || 'Not specified';
            document.getElementById('modalType').querySelector('span').textContent = job.type;
            document.getElementById('modalDescription').textContent = job.description;
            document.getElementById('modalPosted').textContent = `Posted ${formatPostedDate(job.postedAt)}`;
            document.getElementById('modalApplyBtn').href = job.applyUrl;
            
            const modalSaveBtn = document.getElementById('modalSaveBtn');
            modalSaveBtn.innerHTML = `<i class="${isSaved ? 'fas' : 'far'} fa-bookmark"></i> ${isSaved ? 'Saved' : 'Save'}`;
            modalSaveBtn.onclick = () => toggleSaveJob(job.id);
            
            document.getElementById('modalTags').innerHTML = job.tags.map(tag => `
                <span class="px-3 py-1 bg-indigo-500/20 border border-indigo-500/30 rounded-full text-sm text-indigo-300">${tag}</span>
            `).join('');
            
            jobModal.classList.remove('hidden');
            jobModal.classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        // Close modal
        function closeJobModal() {
            jobModal.classList.add('hidden');
            jobModal.classList.remove('flex');
            document.body.style.overflow = '';
            currentJobId = null;
        }

        // Event Listeners
        searchForm.addEventListener('submit', (e) => {
            e.preventDefault();
            usingPreferences = false;
            updatePreferencesIndicators();
            simulateSearch();
        });
        
        countrySelect.addEventListener('change', updateCityOptions);
        
        citySelect.addEventListener('change', () => {
            selectedCity = citySelect.value;
        });
        
        remoteToggle.addEventListener('click', () => {
            isRemoteOnly = !isRemoteOnly;
            remoteToggle.classList.toggle('active');
            if (isRemoteOnly) {
                countrySelect.value = '';
                citySelect.value = '';
                updateCityOptions();
            }
        });

        filtersBtn.addEventListener('click', () => {
            advancedFilters.classList.toggle('hidden');
            filtersIcon.classList.toggle('rotate-180');
        });

        document.querySelectorAll('.quick-filter').forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.dataset.filter;
                activeFilters[filter] = !activeFilters[filter];
                btn.classList.toggle('active');
                updateFilterCount();
                filterJobs();
            });
        });

        document.querySelectorAll('.type-filter').forEach(cb => {
            cb.addEventListener('change', () => {
                if (cb.checked) {
                    activeFilters.types.push(cb.value);
                } else {
                    activeFilters.types = activeFilters.types.filter(t => t !== cb.value);
                }
                updateFilterCount();
                filterJobs();
            });
        });

        document.querySelectorAll('.exp-filter').forEach(cb => {
            cb.addEventListener('change', () => {
                if (cb.checked) {
                    activeFilters.experience.push(cb.value);
                } else {
                    activeFilters.experience = activeFilters.experience.filter(e => e !== cb.value);
                }
                updateFilterCount();
                filterJobs();
            });
        });

        clearFilters.addEventListener('click', () => {
            // Reset all filters
            activeFilters = {
                remote: false,
                'full-time': false,
                entry: false,
                sources: ['all'],
                types: [],
                experience: [],
                salary: []
            };
            
            // Reset UI
            document.querySelectorAll('.quick-filter').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.type-filter, .exp-filter, .salary-filter').forEach(cb => cb.checked = false);
            document.querySelectorAll('.source-filter').forEach(cb => {
                cb.checked = cb.value === 'all';
            });
            
            updateFilterCount();
            filterJobs();
        });

        clearAllBtn.addEventListener('click', () => {
            searchQuery.value = '';
            countrySelect.value = '';
            citySelect.value = '';
            updateCityOptions();
            isRemoteOnly = false;
            remoteToggle.classList.remove('active');
            clearFilters.click();
            simulateSearch();
        });

        sortBy.addEventListener('change', () => {
            sortJobs();
            renderJobs();
        });

        closeModal.addEventListener('click', closeJobModal);
        jobModal.addEventListener('click', (e) => {
            if (e.target === jobModal) closeJobModal();
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeJobModal();
        });
        
        // Ausbildung handlers
        ausbildungYes.addEventListener('click', () => {
            isAusbildungMode = true;
            ausbildungPrompt.classList.add('hidden');
            ausbildungPanel.classList.remove('hidden');
            simulateSearch();
        });
        
        ausbildungNo.addEventListener('click', () => {
            ausbildungPromptDismissed = true;
            ausbildungPrompt.classList.add('hidden');
        });
        
        switchToJobs.addEventListener('click', () => {
            isAusbildungMode = false;
            ausbildungPanel.classList.add('hidden');
            simulateSearch();
        });
        
        // Preferences handlers
        usePreferencesBtn.addEventListener('click', searchWithPreferences);
        clearPreferencesBtn.addEventListener('click', clearPreferencesFromSearch);
        
        // CV badge handler (simulate creating CV)
        cvBadge.addEventListener('click', (e) => {
            e.preventDefault();
            localStorage.setItem('hasCV', 'true');
            hasCV = true;
            cvBadge.classList.add('hidden');
            if (userPreferences) {
                notificationBar.classList.add('hidden');
            }
            alert('CV Builder would open here. CV marked as created for demo.');
        });
        
        // Preferences badge handler (simulate setting preferences)
        preferencesBadge.addEventListener('click', (e) => {
            e.preventDefault();
            userPreferences = {
                titles: ['Software Engineer', 'Frontend Developer'],
                country: 'US',
                remote: true
            };
            localStorage.setItem('userPreferences', JSON.stringify(userPreferences));
            preferencesBadge.classList.add('hidden');
            showPreferencesBar();
            if (hasCV) {
                notificationBar.classList.add('hidden');
            }
            alert('Preferences saved! Click "Use preferences" to search with your saved preferences.');
        });

        // Make functions available globally
        window.changePage = changePage;
        window.toggleSaveJob = toggleSaveJob;

        // Initialize
        initNotifications();
        simulateSearch();
    </script>
</body>
</html>
